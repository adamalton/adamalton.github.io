<html>
	<head>
		<meta charset="utf8">
		<meta http-equiv="title" content="Safari CSP Bug Demo">
		<meta http-equiv="Content-Security-Policy" content="default-src 'self'">
	</head>
	<body>
		<h1>Safari CSP Bug Demo</h1>
		<p>
			This page demonstrates a bug in Safari where the browser's native <code>&lt;audio&gt;</code>
			element is adversely affected by a page's
			<code>Content-Security-Policy</code>.
		</p>
		<h2>Affected Versions</h2>
		<p>
			Reproduced on these versions, but may affect others too:
		</p>
		<ul>
			<li>13.1.1 on macOS 10.13.6</li>
			<li>whatever version runs on iOS 13.5</li>
		</ul>
		<p>
			I've been told that the bug still exists on iOS 14 as well, but I don't know which version.
		</p>

		<h2>Steps to reproduce</h2>
		<ol>
			<li>Create an HTML page with an element <code>&lt;audio controls&gt;&lt;/audio&gt;</code>.</li>
			<li>
				Serve that page with a <code>Content-Security-Policy</code> where the <code>img-src</code>
				(or the implied <code>img-src</code> via <code>default-src</code>)
				does <em>not</em> permit <code>data:</code> URLs.
			</li>
			<li>Load the page in Safari.</li>
		</ol>
		<h2>Observed Behaviour</h2>
		<p>
			Safari displays the audio element, but the control buttons are missing.
			See <a target="_blank" href="/img/safari-csp-bug.png">screenshot</a>.
		</p>
		<h2>Expected Behaviour</h2>
		<p>
			The <code>Content Security Policy</code> should not affect the behaviour of native browser elements.
		</p>
		<h2>Demo</h2>
		<p>(Requires Safari)</p>
		<audio controls></audio>

		<h2>Other Info</h2>
		<p>
			This bug was reported to Apple <a href="https://feedbackassistant.apple.com/feedback/7718020">here</a> on 29th of May 2020.
		</p>
	</body>
</html>
